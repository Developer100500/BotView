# Требования к интеграции с криптовалютными биржами

## Введение

Данная функциональность расширяет существующее WPF приложение для технического анализа криптовалют, добавляя возможность получения реальных данных OHLCV с популярных криптовалютных бирж через библиотеку CCXT. Приложение уже имеет полнофункциональную систему отрисовки свечных графиков с возможностями масштабирования и перемещения, и теперь требуется подключить к ней реальные данные.

## Глоссарий

- **CCXT_Library**: Библиотека ccxt для подключения к криптовалютным биржам
- **Chart_System**: Существующая система отрисовки графиков в приложении
- **Exchange_Service**: Сервис для работы с криптовалютными биржами
- **OHLCV_Data**: Данные свечей в формате Open, High, Low, Close, Volume
- **Market_Symbol**: Торговая пара криптовалют (например, BTC/USDT)
- **Timeframe**: Временной интервал свечей (1m, 5m, 1h, 1d и т.д.)
- **Exchange_List**: Список поддерживаемых бирж в приложении
- **Data_Provider**: Компонент, отвечающий за получение данных с бирж

## Требования

### Требование 1

**Пользовательская история:** Как пользователь приложения, я хочу видеть реальные данные графиков с популярных криптовалютных бирж, чтобы проводить технический анализ актуальных рыночных данных.

#### Критерии приемки

1. THE Exchange_Service SHALL получать реальные OHLCV_Data с криптовалютных бирж через CCXT_Library
2. WHEN пользователь запускает приложение, THE Chart_System SHALL отображать реальный график с данными по умолчанию
3. THE Data_Provider SHALL поддерживать получение данных в различных Timeframe (1m, 5m, 15m, 30m, 1h, 4h, 1d, 1w)
4. THE Exchange_Service SHALL корректно обрабатывать полученные данные и преобразовывать их в формат CandlestickData
5. THE Chart_System SHALL отображать полученные реальные данные с сохранением всех существующих возможностей масштабирования и навигации

### Требование 2

**Пользовательская история:** Как пользователь, я хочу иметь доступ к данным с нескольких популярных бирж, чтобы сравнивать цены и выбирать наиболее подходящий источник данных.

#### Критерии приемки

1. THE Exchange_List SHALL содержать Binance как биржу по умолчанию
2. THE Exchange_List SHALL включать дополнительные популярные биржи (Bybit, OKX, Kraken)
3. THE Exchange_Service SHALL поддерживать переключение между различными биржами из Exchange_List
4. WHEN пользователь выбирает биржу, THE Data_Provider SHALL получать данные с выбранной биржи
5. THE Exchange_Service SHALL обрабатывать различия в API разных бирж через единый интерфейс

### Требование 3

**Пользовательская история:** Как пользователь, я хочу выбирать различные торговые пары для анализа, чтобы исследовать разные криптовалютные рынки.

#### Критерии приемки

1. THE Exchange_Service SHALL поддерживать популярные Market_Symbol (BTC/USDT, ETH/USDT, BNB/USDT)
2. THE Data_Provider SHALL получать данные для выбранного Market_Symbol
3. WHEN пользователь меняет Market_Symbol, THE Chart_System SHALL обновлять отображаемые данные
4. THE Exchange_Service SHALL валидировать доступность Market_Symbol на выбранной бирже
5. IF Market_Symbol недоступен на бирже, THEN THE Exchange_Service SHALL уведомлять пользователя об ошибке

### Требование 4

**Пользовательская история:** Как пользователь, я хочу, чтобы приложение корректно обрабатывало ошибки подключения к биржам, чтобы получать понятную информацию о проблемах.

#### Критерии приемки

1. THE Exchange_Service SHALL обрабатывать ошибки сетевого подключения к биржам
2. WHEN возникает ошибка подключения, THE Exchange_Service SHALL предоставлять понятное сообщение об ошибке
3. THE Data_Provider SHALL реализовывать механизм повторных попыток подключения
4. IF данные не удается получить, THEN THE Chart_System SHALL отображать последние доступные данные или демонстрационные данные
5. THE Exchange_Service SHALL логировать ошибки для диагностики проблем

### Требование 5

**Пользовательская история:** Как пользователь, я хочу, чтобы загрузка данных происходила эффективно, чтобы не ждать долго обновления графика.

#### Критерии приемки

1. THE Data_Provider SHALL загружать данные асинхронно без блокировки пользовательского интерфейса
2. THE Exchange_Service SHALL кэшировать полученные данные для повышения производительности
3. WHEN данные загружаются, THE Chart_System SHALL показывать индикатор загрузки
4. THE Data_Provider SHALL загружать оптимальное количество свечей (не более 1000 за один запрос)
5. THE Exchange_Service SHALL обновлять данные только при необходимости (смена биржи, символа, таймфрейма или скроллинг до края графика)